Тест индексов показал следующие результаты:


=== Тестирование без индексов ===

B-tree: Точечный поиск по цене: 15.40 ms

B-tree: Диапазон цен: 929.20 μs

B-tree: Сортировка по цене: 316.01 ms

GIN: Поиск слова в любом месте текста: 926.50 μs

GIN: Поиск фразы: 1.71 s

GIN: Поиск с использованием триграмм: 2.40 s

BRIN: Диапазон по последовательным значениям цены: 1.30 ms

BRIN: Агрегация по категориям: 400.32 ms

BRIN: Диапазон по упорядоченным данным: 761.90 μs


=== Создание индекса: B-tree индекс на price ===

B-tree: Точечный поиск по цене: 774.50 μs (ускорение в 19.89x)

B-tree: Диапазон цен: 728.60 μs (ускорение в 1.28x)

B-tree: Сортировка по цене: 688.80 μs (ускорение в 458.79x)


=== Создание индекса: GIN индекс на name (триграммы) ===

GIN: Поиск слова в любом месте текста: 778.90 μs (ускорение в 1.19x)

GIN: Поиск фразы: 4.77 s (ускорение в 0.36x)

GIN: Поиск с использованием триграмм: 1.26 ms (ускорение в 1901.59x)


=== Создание индекса: BRIN индекс на product_id ===

BRIN: Диапазон по последовательным значениям цены: 1.12 ms (ускорение в 1.16x)

BRIN: Агрегация по категориям: 405.80 ms (ускорение в 0.99x)

BRIN: Диапазон по упорядоченным данным: 602.10 μs (ускорение в 1.27x)


=== Тестирование всех индексов одновременно ===

B-tree: Точечный поиск по цене: 1.36 ms (ускорение в 11.36x)

B-tree: Диапазон цен: 1.22 ms (ускорение в 0.76x)

B-tree: Сортировка по цене: 896.20 μs (ускорение в 352.62x)

GIN: Поиск слова в любом месте текста: 681.50 μs (ускорение в 1.36x)

GIN: Поиск фразы: 5.05 s (ускорение в 0.34x)

GIN: Поиск с использованием триграмм: 887.60 μs (ускорение в 2702.20x)

BRIN: Диапазон по последовательным значениям цены: 835.20 μs (ускорение в 1.55x)

BRIN: Агрегация по категориям: 419.39 ms (ускорение в 0.95x)

BRIN: Диапазон по упорядоченным данным: 767.10 μs (ускорение в 0.99x)



Исходя из результатов теста можно сделать следующие выводы:

1. B-tree - Древовидная структура для быстрого поиска по упорядоченным данным.

**Хорошо проявляет себя при**:
- Точечные запросы (`WHERE id = 123` → ускорение **20x**)  
- Сортировки (`ORDER BY price` → ускорение **450x**)  
- Префиксный поиск (`LIKE 'Чай%'`)  

**Недостатки**:  
- Не поддерживает `LIKE '%подстрока%'`  
- Замедляет вставку данных  


2. GIN (Триграммный индекс) - Разбивает текст на группы по 3 символа для поиска подстрок.
   
**Хорошо проявляет себя при**: 
- Поиск слов через regex (`WHERE name ~ '\yчай\y'` → ускорение **1900x**)  
- Нечёткий поиск (опечатки)  

**Недостатки**:  
- Бесполезен для фраз (`LIKE '%зелёный чай%'` → замедление **3x**)


3. BRIN - Работает с блоками данных, а не отдельными строками.
   
**Хорошо проявляет себя при**:  
- Большие таблицы 
- Данные с естественным порядком (например, временные метки)  

**Недостатки**:  
- Малоэффективен для маленьких таблиц (5M строк → ускорение всего **1.2x**)  
- Бесполезен для точечных запросов  



Для большинства задач можно использовать B-tree — он идеален для точных запросов, диапазонов и сортировок. GIN с триграммами можно использовать только для специализированного текстового поиска (регулярные выражения, точные слова). BRIN эффективен лишь для очень больших упорядоченных таблиц. Индекс B-tree можно использовать почти всегда, в то время как остальные два нужно использовать с умом и необходимостью.
